{"version":3,"file":"index.js","sources":["../node_modules/_hyperapp@1.0.2@hyperapp/src/index.js","../src/tile.js","../src/tile-container.js","../src/index.js"],"sourcesContent":["export function h(name, props) {\n  var node\n  var rest = []\n  var children = []\n  var length = arguments.length\n\n  while (length-- > 2) rest.push(arguments[length])\n\n  while (rest.length) {\n    if (Array.isArray((node = rest.pop()))) {\n      for (length = node.length; length--; ) {\n        rest.push(node[length])\n      }\n    } else if (node != null && node !== true && node !== false) {\n      children.push(node)\n    }\n  }\n\n  return typeof name === \"function\"\n    ? name(props || {}, children)\n    : {\n        name: name,\n        props: props || {},\n        children: children\n      }\n}\n\nexport function app(state, actions, view, container) {\n  var renderLock\n  var invokeLaterStack = []\n  var rootElement = (container && container.children[0]) || null\n  var lastNode = rootElement && toVNode(rootElement, [].map)\n  var globalState = copy(state)\n  var wiredActions = copy(actions)\n\n  scheduleRender(wireStateToActions([], globalState, wiredActions))\n\n  return wiredActions\n\n  function toVNode(element, map) {\n    return {\n      name: element.nodeName.toLowerCase(),\n      props: {},\n      children: map.call(element.childNodes, function(element) {\n        return element.nodeType === 3\n          ? element.nodeValue\n          : toVNode(element, map)\n      })\n    }\n  }\n\n  function render() {\n    renderLock = !renderLock\n\n    var next = view(globalState, wiredActions)\n    if (container && !renderLock) {\n      rootElement = patch(container, rootElement, lastNode, (lastNode = next))\n    }\n\n    while ((next = invokeLaterStack.pop())) next()\n  }\n\n  function scheduleRender() {\n    if (!renderLock) {\n      renderLock = !renderLock\n      setTimeout(render)\n    }\n  }\n\n  function copy(target, source) {\n    var obj = {}\n\n    for (var i in target) obj[i] = target[i]\n    for (var i in source) obj[i] = source[i]\n\n    return obj\n  }\n\n  function set(path, value, source) {\n    var target = {}\n    if (path.length) {\n      target[path[0]] =\n        path.length > 1 ? set(path.slice(1), value, source[path[0]]) : value\n      return copy(source, target)\n    }\n    return value\n  }\n\n  function get(path, source) {\n    for (var i = 0; i < path.length; i++) {\n      source = source[path[i]]\n    }\n    return source\n  }\n\n  function wireStateToActions(path, state, actions) {\n    for (var key in actions) {\n      typeof actions[key] === \"function\"\n        ? (function(key, action) {\n            actions[key] = function(data) {\n              if (typeof (data = action(data)) === \"function\") {\n                data = data(get(path, globalState), actions)\n              }\n\n              if (\n                data &&\n                data !== (state = get(path, globalState)) &&\n                !data.then // Promise\n              ) {\n                scheduleRender(\n                  (globalState = set(path, copy(state, data), globalState))\n                )\n              }\n\n              return data\n            }\n          })(key, actions[key])\n        : wireStateToActions(\n            path.concat(key),\n            (state[key] = state[key] || {}),\n            (actions[key] = copy(actions[key]))\n          )\n    }\n  }\n\n  function getKey(node) {\n    return node && node.props ? node.props.key : null\n  }\n\n  function setElementProp(element, name, value, isSVG, oldValue) {\n    if (name === \"key\") {\n    } else if (name === \"style\") {\n      for (var i in copy(oldValue, value)) {\n        element[name][i] = value == null || value[i] == null ? \"\" : value[i]\n      }\n    } else {\n      if (typeof value === \"function\" || (name in element && !isSVG)) {\n        element[name] = value == null ? \"\" : value\n      } else if (value != null && value !== false) {\n        element.setAttribute(name, value)\n      }\n\n      if (value == null || value === false) {\n        element.removeAttribute(name)\n      }\n    }\n  }\n\n  function createElement(node, isSVG) {\n    var element =\n      typeof node === \"string\" || typeof node === \"number\"\n        ? document.createTextNode(node)\n        : (isSVG = isSVG || node.name === \"svg\")\n          ? document.createElementNS(\"http://www.w3.org/2000/svg\", node.name)\n          : document.createElement(node.name)\n\n    if (node.props) {\n      if (node.props.oncreate) {\n        invokeLaterStack.push(function() {\n          node.props.oncreate(element)\n        })\n      }\n\n      for (var i = 0; i < node.children.length; i++) {\n        element.appendChild(createElement(node.children[i], isSVG))\n      }\n\n      for (var name in node.props) {\n        setElementProp(element, name, node.props[name], isSVG)\n      }\n    }\n\n    return element\n  }\n\n  function updateElement(element, oldProps, props, isSVG) {\n    for (var name in copy(oldProps, props)) {\n      if (\n        props[name] !==\n        (name === \"value\" || name === \"checked\"\n          ? element[name]\n          : oldProps[name])\n      ) {\n        setElementProp(element, name, props[name], isSVG, oldProps[name])\n      }\n    }\n\n    if (props.onupdate) {\n      invokeLaterStack.push(function() {\n        props.onupdate(element, oldProps)\n      })\n    }\n  }\n\n  function removeChildren(element, node, props) {\n    if ((props = node.props)) {\n      for (var i = 0; i < node.children.length; i++) {\n        removeChildren(element.childNodes[i], node.children[i])\n      }\n\n      if (props.ondestroy) {\n        props.ondestroy(element)\n      }\n    }\n    return element\n  }\n\n  function removeElement(parent, element, node, cb) {\n    function done() {\n      parent.removeChild(removeChildren(element, node))\n    }\n\n    if (node.props && (cb = node.props.onremove)) {\n      cb(element, done)\n    } else {\n      done()\n    }\n  }\n\n  function patch(parent, element, oldNode, node, isSVG, nextSibling) {\n    if (node === oldNode) {\n    } else if (oldNode == null) {\n      element = parent.insertBefore(createElement(node, isSVG), element)\n    } else if (node.name && node.name === oldNode.name) {\n      updateElement(\n        element,\n        oldNode.props,\n        node.props,\n        (isSVG = isSVG || node.name === \"svg\")\n      )\n\n      var oldElements = []\n      var oldKeyed = {}\n      var newKeyed = {}\n\n      for (var i = 0; i < oldNode.children.length; i++) {\n        oldElements[i] = element.childNodes[i]\n\n        var oldChild = oldNode.children[i]\n        var oldKey = getKey(oldChild)\n\n        if (null != oldKey) {\n          oldKeyed[oldKey] = [oldElements[i], oldChild]\n        }\n      }\n\n      var i = 0\n      var j = 0\n\n      while (j < node.children.length) {\n        var oldChild = oldNode.children[i]\n        var newChild = node.children[j]\n\n        var oldKey = getKey(oldChild)\n        var newKey = getKey(newChild)\n\n        if (newKeyed[oldKey]) {\n          i++\n          continue\n        }\n\n        if (newKey == null) {\n          if (oldKey == null) {\n            patch(element, oldElements[i], oldChild, newChild, isSVG)\n            j++\n          }\n          i++\n        } else {\n          var recyledNode = oldKeyed[newKey] || []\n\n          if (oldKey === newKey) {\n            patch(element, recyledNode[0], recyledNode[1], newChild, isSVG)\n            i++\n          } else if (recyledNode[0]) {\n            patch(\n              element,\n              element.insertBefore(recyledNode[0], oldElements[i]),\n              recyledNode[1],\n              newChild,\n              isSVG\n            )\n          } else {\n            patch(element, oldElements[i], null, newChild, isSVG)\n          }\n\n          j++\n          newKeyed[newKey] = newChild\n        }\n      }\n\n      while (i < oldNode.children.length) {\n        var oldChild = oldNode.children[i]\n        if (getKey(oldChild) == null) {\n          removeElement(element, oldElements[i], oldChild)\n        }\n        i++\n      }\n\n      for (var i in oldKeyed) {\n        if (!newKeyed[oldKeyed[i][1].props.key]) {\n          removeElement(element, oldKeyed[i][0], oldKeyed[i][1])\n        }\n      }\n    } else if (node.name === oldNode.name) {\n      element.nodeValue = node\n    } else {\n      element = parent.insertBefore(\n        createElement(node, isSVG),\n        (nextSibling = element)\n      )\n      removeElement(parent, nextSibling, oldNode)\n    }\n    return element\n  }\n}\n","/**\n * 2018/2/1\n *\n * Copyright(c) Alibaba Group Holding Limited.\n *\n * Authors:\n *   乔杨 <peiqiao.ppq@alipay.com>\n */\n\n\"use strict\";\n\nimport { h } from \"hyperapp\";\n\nexport default function({ x, y, size, key, extraClass, onclick }) {\n  return h(\"div\", {\n    class: extraClass ? `tile ${extraClass}` : \"tile\",\n    key,\n    style: {\n      left: x * size + \"px\",\n      top: y * size + \"px\",\n      width: size + \"px\",\n      height: size + \"px\"\n    },\n    onclick: () => onclick(key)\n  });\n}\n","/**\n * 2018/2/1\n *\n * Copyright(c) Alibaba Group Holding Limited.\n *\n * Authors:\n *   乔杨 <peiqiao.ppq@alipay.com>\n */\n\n\"use strict\";\n\nimport { h } from \"hyperapp\";\nimport Tile from \"./tile\";\n\nexport default function({\n  size,\n  containerWidth,\n  position,\n  startIndex,\n  startClassName,\n  status\n}, actions) {\n  const shouldShowStartTile = status === \"start\" || status === \"over\";\n  const children = position.map((v, key) =>\n    Tile({\n      key,\n      size: containerWidth / size,\n      x: v % size,\n      y: Math.floor(v / size),\n      extraClass: shouldShowStartTile\n        ? key === startIndex ? startClassName : null\n        : null,\n      onclick: index => actions.pickTile(index)\n    })\n  );\n  return h(\n    \"div\",\n    {\n      class: \"tile-container\",\n      style: {\n        height: containerWidth + \"px\"\n      }\n    },\n    children\n  );\n}\n","import { h, app } from \"hyperapp\";\nimport TileContainer from \"./tile-container\";\n\nconst __STYLE_TAG_ID = \"__vision_style\";\n\nconst DEFAULT_CONFIG = {\n  size: 4,\n  moveInterval: 800,\n  moveDuration: 800,\n  moveSteps: 5,\n  startDelay: 1000,\n  startClassName: \"\",\n  startButtonText: \"START !\",\n  retryButtonText: \"RETRY !\"\n};\n\nclass Vision {\n  constructor(config) {\n    this.config = Object.assign({}, DEFAULT_CONFIG, config);\n    if (this.config.container instanceof HTMLElement === false) {\n      throw new TypeError(\n        \"Did you forget to pass a container to the constructor ?\"\n      );\n    }\n    const containerWidth = this.config.container.getBoundingClientRect().width;\n    if (containerWidth <= 0) {\n      throw new Error(\"container must have a initial width.\");\n    }\n    this.state = {\n      size: this.config.size,\n      containerWidth,\n      status: \"init\",\n      moving: false,\n      startClassName: this.config.startClassName\n    };\n    this.actions = {\n      initTilePosition: () => state => {\n        const position = [];\n        for (let i = 0; i < state.size * state.size; i++) {\n          position.push(i);\n        }\n        return { position };\n      },\n      randomTilePosition: count => state => {\n        const position = state.position;\n        count = count || position.length;\n        for (let i = 0; i < count; i++) {\n          randomSwapArrayItem(\n            position,\n            Math.floor(Math.random() * position.length)\n          );\n        }\n        if (state.startIndex) {\n          randomSwapArrayItem(position, state.startIndex);\n        }\n        console.debug(\"randomTilePosition\", position);\n        return { position };\n      },\n      startGame: () => state => {\n        if (state.status === \"init\" || state.status === \"over\") {\n          return {\n            status: \"start\",\n            startIndex: Math.floor(Math.random() * state.size * state.size)\n          };\n        }\n        return {};\n      },\n      startMoving: () => state => ({ status: \"moving\" }),\n      stopMoving: () => state => ({ status: \"waiting\" }),\n      pickTile: index => state => {\n        if (state.status !== \"waiting\") {\n          return {};\n        }\n        const isWin = Number(index) === Number(state.startIndex);\n        if (typeof this.config.onGameOver === \"function\") {\n          setTimeout(this.config.onGameOver.bind(this, isWin), 50);\n        }\n        return { isWin, status: \"over\" };\n      }\n    };\n    this._init();\n  }\n\n  _init() {\n    updateTileMoveSpeed(this.config.moveDuration / 1000);\n    const view = (state, actions) =>\n      h(\"div\", { class: \"game-container\" }, [\n        TileContainer(state, actions),\n        h(\n          \"div\",\n          {\n            style: {\n              display: state.status === \"init\" ? \"block\" : \"none\"\n            },\n            onclick: this.start.bind(this)\n          },\n          this.config.startButtonText\n        ),\n        h(\n          \"div\",\n          {\n            style: {\n              display: state.status === \"over\" ? \"block\" : \"none\"\n            },\n            onclick: this.start.bind(this)\n          },\n          this.config.retryButtonText\n        )\n      ]);\n    this.app = app(this.state, this.actions, view, this.config.container);\n    this.app.initTilePosition();\n  }\n\n  start() {\n    this.app.startGame();\n    setTimeout(() => {\n      this.app.startMoving();\n      setTimeout(() => {\n        this._move(this.config.moveSteps);\n      }, this.config.startDelay);\n    }, this.config.startDelay);\n  }\n\n  _move(countdown) {\n    if (countdown <= 0) {\n      this.app.stopMoving();\n      return;\n    }\n    this.app.randomTilePosition();\n    setTimeout(this._move.bind(this, countdown - 1), this.config.moveInterval);\n  }\n}\n\n/**\n * randomly swap array item\n * @param {Array} arr\n * @param {number} index\n */\nfunction randomSwapArrayItem(arr, index) {\n  let randomIndex = index;\n  while (randomIndex === index) {\n    randomIndex = Math.floor(Math.random() * arr.length);\n  }\n  const swap = arr[index];\n  arr[index] = arr[randomIndex];\n  arr[randomIndex] = swap;\n  console.debug(\"swap\", index, \"->\", randomIndex);\n}\n\n/**\n * update style\n * @param {number} second\n */\nfunction updateTileMoveSpeed(second) {\n  const style = document.getElementById(__STYLE_TAG_ID);\n  const innerText = `.tile-container .tile { -webkit-transition: top ${second}s, left ${second}s; transition: top ${second}s, left ${second}s; }`;\n  if (style) {\n    style.innerText = innerText;\n  } else {\n    const el = document.createElement(\"style\");\n    el.id = __STYLE_TAG_ID;\n    el.innerText = innerText;\n    el.type = \"text/css\";\n    document.head.appendChild(el);\n  }\n}\n\nexport default Vision;\n"],"names":["x","y","size","key","extraClass","onclick","h","actions","containerWidth","position","startIndex","startClassName","status","shouldShowStartTile","children","map","v","Tile","Math","floor","pickTile","index","__STYLE_TAG_ID","DEFAULT_CONFIG","Vision","config","Object","assign","container","HTMLElement","TypeError","getBoundingClientRect","width","Error","state","i","push","count","length","random","debug","isWin","Number","onGameOver","bind","_init","moveDuration","view","class","TileContainer","start","startButtonText","retryButtonText","app","initTilePosition","startGame","startMoving","_move","moveSteps","startDelay","countdown","stopMoving","randomTilePosition","moveInterval","randomSwapArrayItem","arr","randomIndex","swap","updateTileMoveSpeed","second","style","document","getElementById","innerText","el","createElement","id","type","head","appendChild"],"mappings":"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"}